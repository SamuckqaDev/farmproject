databaseChangeLog:
  - changeSet:
      id: "1"
      author: samuckqadev
      changes:
        # CUSTOMER
        - createTable:
            tableName: tb_customer
            columns:
              - column: { name: id_customer, type: UUID, defaultValueComputed: "gen_random_uuid()", constraints: { primaryKey: true, nullable: false } }
              - column: { name: name, type: VARCHAR(144), constraints: { nullable: false } }
              - column: { name: elegible_discount, type: BOOLEAN, defaultValueBoolean: false }

        # SELLER
        - createTable:
            tableName: tb_seller
            columns:
              - column: { name: id_seller, type: UUID, defaultValueComputed: "gen_random_uuid()", constraints: { primaryKey: true, nullable: false } }
              - column: { name: name, type: VARCHAR(255), constraints: { nullable: false } }
              - column: { name: cpf, type: VARCHAR(14), constraints: { unique: true, nullable: false } }
              - column: { name: registration, type: VARCHAR(50), constraints: { unique: true, nullable: false } }

        # DUCK
        - createTable:
            tableName: tb_duck
            columns:
              - column: { name: id_duck, type: UUID, defaultValueComputed: "gen_random_uuid()", constraints: { primaryKey: true, nullable: false } }
              - column: { name: name, type: VARCHAR(255), constraints: { nullable: false } }
              - column: { name: id_mother, type: UUID, constraints: { foreignKeyName: fk_duck_mother, referencedTableName: tb_duck, referencedColumnNames: id_duck } }
              - column: { name: status, type: VARCHAR(20), defaultValue: "AVAILABLE", constraints: { nullable: false } }
        
        - sql:
            sql: "ALTER TABLE tb_duck ADD CONSTRAINT chk_duck_status CHECK (status IN ('AVAILABLE', 'SALED'));"

        # SALE
        - createTable:
            tableName: tb_sale
            columns:
              - column: { name: id_sale, type: UUID, defaultValueComputed: "gen_random_uuid()", constraints: { primaryKey: true, nullable: false } }
              - column: { name: id_customer, type: UUID, constraints: { nullable: false, foreignKeyName: fk_sale_customer, referencedTableName: tb_customer, referencedColumnNames: id_customer } }
              - column: { name: id_seller, type: UUID, constraints: { nullable: false, foreignKeyName: fk_sale_seller, referencedTableName: tb_seller, referencedColumnNames: id_seller } }
              - column: { name: sale_date, type: TIMESTAMP, defaultValueComputed: "CURRENT_TIMESTAMP" }
              - column: { name: total_value, type: "DECIMAL(10, 2)" }

        # SALE_ITEM
        - createTable:
            tableName: tb_sale_item
            columns:
              - column: { name: id_sale_item, type: UUID, defaultValueComputed: "gen_random_uuid()", constraints: { primaryKey: true, nullable: false } }
              - column: { name: id_sale, type: UUID, constraints: { nullable: false, foreignKeyName: fk_item_sale, referencedTableName: tb_sale, referencedColumnNames: id_sale } }
              - column: { name: id_duck, type: UUID, constraints: { nullable: false, unique: true, foreignKeyName: fk_item_duck, referencedTableName: tb_duck, referencedColumnNames: id_duck } }
              - column: { name: unit_price, type: "DECIMAL(10, 2)", constraints: { nullable: false } }